<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>General tips &mdash; Ansible Community Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5707b69d" />
      <link rel="stylesheet" type="text/css" href="../_static/css/ansible.css?v=c5b67dd2" />
      <link rel="stylesheet" type="text/css" href="../_static/antsibull-minimal.css" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/css/rtd-ethical-ads.css?v=289b023e" />

  
    <link rel="shortcut icon" href="../_static/images/Ansible-Mark-RGB_Black.png"/>
    <link rel="canonical" href="https://docs.ansible.com/ansible/latest/tips_tricks/ansible_tips_tricks.html"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=c7b8e248"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sample Ansible setup" href="sample_setup.html" />
    <link rel="prev" title="Ansible tips and tricks" href="index.html" /><!-- extra head elements for Ansible beyond RTD Sphinx Theme -->
<script src="https://www.redhat.com/dtm.js"></script>


<!-- <meta class="swiftype" name="published_at" data-type="date" content="2017-12-13" /> -->
<meta class="swiftype" name="version" data-type="string" content="devel">

<!-- Google Tag Manager Data Layer -->
<script>
 dataLayer = [];
</script>
<!-- End Google Tag Manager Data Layer -->



<script>
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','https://s.swiftypecdn.com/install/v2/st.js','_st');

_st('install','yABGvz2N8PwcwBxyfzUc','2.0.0');
</script>

</head>

<body class="wy-body-for-nav"><!-- extra body elements for Ansible beyond RTD Sphinx Theme -->
<!-- Google Tag Manager -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PSB293" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-PSB293');</script>
<!-- End Google Tag Manager -->

<div class="DocSite-globalNav ansibleNav">
  <ul>
    <li><a href="https://www.ansible.com/blog" target="_blank">Blog</a></li>
    <li><a href="https://forum.ansible.com/" target="_blank">Ansible community forum</a></li>
    <li><a href="https://docs.ansible.com/" target="_blank">Documentation</a></li>
  </ul>
</div>

<a class="DocSite-nav" href="/" style="padding-bottom: 30px;">

  <img class="DocSiteNav-logo"
    src="../_static/images/Ansible-Mark-RGB_White.png"
    alt="Ansible Logo">
  <div class="DocSiteNav-title">Ansible Community Documentation</div>
</a>
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Ansible
          </a>
              <div class="version">
                devel
              </div><!--- Based on https://github.com/rtfd/sphinx_rtd_theme/pull/438/files -->

<div class="version">
  
    <form class="version-dropdown" method="get">
      <script>
        function switchVersionTo(slug) {
          var current_url_path = window.location.pathname;
          var url_version = current_url_path.search("/devel/") > -1
            ? "/devel/"
            : "/latest/";
          var new_version_url = current_url_path.replace(url_version, "/" + slug + "/");
          window.location.replace(new_version_url);
        }
      </script>
      <label class="sr-only" for="version-list">Select version:</label>
      <select
          class="version-list"
          id="version-list"
          onchange="switchVersionTo(this.value);"
      >
        
        <option
            value="latest"
            
        >
            latest
        </option>
        
        <option
            value="9"
            
        >
            9
        </option>
        
        <option
            value="2.9"
            
        >
            2.9
        </option>
        
        <option
            value="devel"
            selected="selected"
        >
            devel
        </option>
        
      </select>
    </form>
  
</div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" method="get">
    <label class="sr-only" for="q">Search docs:</label>
    <input type="text" class="st-default-search-input" id="q" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
              <p class="caption" role="heading"><span class="caption-text">Ansible getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting started with Ansible</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started_ee/index.html">Getting started with Execution Environments</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation, Upgrade &amp; Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation_guide/index.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../porting_guides/porting_guides.html">Ansible Porting Guides</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using Ansible</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../inventory_guide/index.html">Building Ansible inventories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../command_guide/index.html">Using Ansible command line tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../playbook_guide/index.html">Using Ansible playbooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vault_guide/index.html">Protecting sensitive data with Ansible vault</a></li>
<li class="toctree-l1"><a class="reference internal" href="../module_plugin_guide/index.html">Using Ansible modules and plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../collections_guide/index.html">Using Ansible collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../os_guide/index.html">Using Ansible on Windows and BSD</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Ansible tips and tricks</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">General tips</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#keep-it-simple">Keep it simple</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-version-control">Use version control</a></li>
<li class="toctree-l3"><a class="reference internal" href="#customize-the-cli-output">Customize the CLI output</a></li>
<li class="toctree-l3"><a class="reference internal" href="#avoid-configuration-dependent-content">Avoid configuration-dependent content</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#playbook-tips">Playbook tips</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#use-whitespace">Use whitespace</a></li>
<li class="toctree-l3"><a class="reference internal" href="#always-name-plays-tasks-and-blocks">Always name plays, tasks, and blocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#always-mention-the-state">Always mention the state</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-comments">Use comments</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-fully-qualified-collection-names">Use fully qualified collection names</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#inventory-tips">Inventory tips</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#use-dynamic-inventory-with-clouds">Use dynamic inventory with clouds</a></li>
<li class="toctree-l3"><a class="reference internal" href="#group-inventory-by-function">Group inventory by function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#separate-production-and-staging-inventory">Separate production and staging inventory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#keep-vaulted-variables-safely-visible">Keep vaulted variables safely visible</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#execution-tricks">Execution tricks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#use-execution-environments">Use Execution Environments</a></li>
<li class="toctree-l3"><a class="reference internal" href="#try-it-in-staging-first">Try it in staging first</a></li>
<li class="toctree-l3"><a class="reference internal" href="#update-in-batches">Update in batches</a></li>
<li class="toctree-l3"><a class="reference internal" href="#handling-os-and-distro-differences">Handling OS and distro differences</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sample_setup.html">Sample Ansible setup</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing to Ansible</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../community/index.html">Ansible Community Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community/contributions_collections.html">Ansible Collections Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community/contributions.html">ansible-core Contributors Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community/advanced_index.html">Advanced Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/style_guide/index.html">Ansible documentation style guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extending Ansible</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/index.html">Developer Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Common Ansible Scenarios</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scenario_guides/cloud_guides.html">Legacy Public Cloud Guides</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Network Automation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../network/getting_started/index.html">Network Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/user_guide/index.html">Network Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/dev_guide/index.html">Network Developer Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Ansible Galaxy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../galaxy/user_guide.html">Galaxy User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../galaxy/dev_guide.html">Galaxy Developer Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference &amp; Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../collections/index.html">Collection Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../collections/all_plugins.html">Indexes of all modules and plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/playbooks_keywords.html">Playbook Keywords</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/common_return_values.html">Return Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/config.html">Ansible Configuration Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/general_precedence.html">Controlling how Ansible behaves: precedence rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/YAMLSyntax.html">YAML Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/python_3_support.html">Python 3 Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/interpreter_discovery.html">Interpreter Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/release_and_maintenance.html">Releases and maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/test_strategies.html">Testing Strategies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/testing/sanity/index.html">Sanity Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/module_utils.html">Ansible Reference: Module Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/special_variables.html">Special Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/tower.html">Red Hat Ansible Automation Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/automationhub.html">Ansible Automation Hub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/logging.html">Logging Ansible output</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Roadmaps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../roadmap/ansible_roadmap_index.html">Ansible Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap/ansible_core_roadmap_index.html">ansible-core Roadmaps</a></li>
</ul>
<!-- extra nav elements for Ansible beyond RTD Sphinx Theme -->
<!-- changeable widget links to tower - do not change as image controlled by Ansible-->
<div id="sideBanner">
  <br/>
  <a href="https://www.ansible.com/docs-left?utm_source=docs">
    <img style="border-width:0px;" src="https://cdn2.hubspot.net/hubfs/330046/docs-graphics/ASB-docs-left-rail.png" />
  </a>
  <br/><br/><br/>
</div>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Ansible</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Ansible tips and tricks</a></li>
      <li class="breadcrumb-item active">General tips</li>
  <li class="wy-breadcrumbs-aside">
            <!-- Remove main index page as it is no longer editable -->
            
              <a href="https://github.com/ansible/ansible-documentation/edit/devel/docs/docsite/rst/tips_tricks/ansible_tips_tricks.rst?description=%23%23%23%23%23%20SUMMARY%0A%3C!---%20Your%20description%20here%20--%3E%0A%0A%0A%23%23%23%23%23%20ISSUE%20TYPE%0A-%20Docs%20Pull%20Request%0A%0A%2Blabel:%20docsite_pr" class="fa fa-github"> Edit on GitHub</a>
            
  </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  <script>
    function startsWith(str, needle) {
      return str.slice(0, needle.length) == needle
    }
    function startsWithOneOf(str, needles) {
      return needles.some(function (needle) {
        return startsWith(str, needle);
      });
    }
    var banner = '';
      var extra_banner = '';
    /*use extra_banner for when we want something extra, like a survey or Community Day notice */
   /*  var extra_banner =
      '<div id="latest_extra_banner_id" class="admonition important">' +
        '<p style="padding-bottom: 1.2rem;">' +
        'Discuss Ansible in the new <a href="https://forum.ansible.com/t/welcome-to-the-ansible-community/5">Ansible Forum!</a>' +
        '</p>' +
      '</div>';
      */
    // Create a banner if we're not on the official docs site
    if (location.host == "docs.testing.ansible.com") {
      document.write('<div id="testing_banner_id" class="admonition important">' +
                     '<p>This is the testing site for Ansible Documentation. Unless you are reviewing pre-production changes, please visit the <a href="https://docs.ansible.com/ansible/latest/">official documentation website</a>.</p> <p></p>' +
                     '</div>');
    }
    
      // Create a banner
      current_url_path = window.location.pathname;

      var important = false;
      var msg = '<p>';
      if (startsWith(current_url_path, "/ansible-core/")) {
        msg += 'You are reading documentation for Ansible Core, which contains no plugins except for those in ansible.builtin. For documentation of the Ansible package, go to <a href="/ansible/latest">the latest documentation</a>.';
      } else if (startsWithOneOf(current_url_path, ["/ansible/latest/", "/ansible/10/"])) {
        /* temp extra banner to advertise something */
        banner += extra_banner;

        msg += 'This is the <b>latest</b> (stable) Ansible community documentation. For Red Hat Ansible Automation Platform subscriptions, see <a href="https://access.redhat.com/support/policy/updates/ansible-automation-platform">Life Cycle</a> for version details.';
      } else if (startsWith(current_url_path, "/ansible/2.9/")) {
        msg += 'You are reading the latest Red Hat released version of the Ansible documentation. Community users can use this version, or select <b>latest</b> from the version selector to the left for the most recent community version.';
      } else if (startsWith(current_url_path, "/ansible/devel/")) {
        /* temp extra banner to advertise something */
        banner += extra_banner;

        msg += 'You are reading the <b>devel</b> version of the Ansible documentation - this version is not guaranteed stable. Use the version selection to the left if you want the <b>latest</b> (stable) released version.';
      } else {
        msg += 'You are reading an older version of the Ansible documentation. Use the version selection to the left if you want the <b>latest</b> (stable) released version.';
        /* temp extra banner to advertise something - this is for testing*/
        banner += extra_banner;

      }
      msg += '</p>';

      banner += '<div id="banner_id" class="admonition ';
      banner += important ? 'important' : 'caution';
      banner += '">';
      banner += important ? '<br>' : '';
      banner += msg;
      banner += important ? '<br>' : '';
      banner += '</div>';
      document.write(banner);
    
  </script>


  
           <div itemprop="articleBody">
             
  <section id="general-tips">
<span id="tips-and-tricks"></span><h1>General tips<a class="headerlink" href="#general-tips" title="Link to this heading"></a></h1>
<p>These concepts apply to all Ansible activities and artifacts.</p>
<section id="keep-it-simple">
<h2>Keep it simple<a class="headerlink" href="#keep-it-simple" title="Link to this heading"></a></h2>
<p>Whenever you can, do things simply.</p>
<p>Use advanced features only when necessary, and select the feature that best matches your use case.
For example, you will probably not need <code class="docutils literal notranslate"><span class="pre">vars</span></code>, <code class="docutils literal notranslate"><span class="pre">vars_files</span></code>, <code class="docutils literal notranslate"><span class="pre">vars_prompt</span></code> and <code class="docutils literal notranslate"><span class="pre">--extra-vars</span></code> all at once, while also using an external inventory file.</p>
<p>If something feels complicated, it probably is. Take the time to look for a simpler solution.</p>
</section>
<section id="use-version-control">
<h2>Use version control<a class="headerlink" href="#use-version-control" title="Link to this heading"></a></h2>
<p>Keep your playbooks, roles, inventory, and variables files in <code class="docutils literal notranslate"><span class="pre">git</span></code> or another version control system and make commits with meaningful comments to the repository when you make changes.
Version control gives you an audit trail describing when and why you changed the rules that automate your infrastructure.</p>
</section>
<section id="customize-the-cli-output">
<h2>Customize the CLI output<a class="headerlink" href="#customize-the-cli-output" title="Link to this heading"></a></h2>
<p>You can change the output from Ansible CLI commands using <a class="reference internal" href="../plugins/callback.html#callback-plugins"><span class="std std-ref">Callback plugins</span></a>.</p>
</section>
<section id="avoid-configuration-dependent-content">
<h2>Avoid configuration-dependent content<a class="headerlink" href="#avoid-configuration-dependent-content" title="Link to this heading"></a></h2>
<p>To ensure that your automation project is easy to understand, modify, and share with others, you should avoid configuration-dependent content. For example, rather than referencing an <code class="docutils literal notranslate"><span class="pre">ansible.cfg</span></code> as the root of a project, you can use magic variables such as <code class="docutils literal notranslate"><span class="pre">playbook_dir</span></code> or <code class="docutils literal notranslate"><span class="pre">role_name</span></code> to determine paths relative to known locations within your project directory. This can help to keep automation content flexible, reusable, and easy to maintain. For more information, see <a class="reference internal" href="../reference_appendices/special_variables.html#special-variables"><span class="std std-ref">special variables</span></a>.</p>
</section>
</section>
<section id="playbook-tips">
<span id="id1"></span><h1>Playbook tips<a class="headerlink" href="#playbook-tips" title="Link to this heading"></a></h1>
<p>These tips help make playbooks and roles easier to read, maintain, and debug.</p>
<section id="use-whitespace">
<h2>Use whitespace<a class="headerlink" href="#use-whitespace" title="Link to this heading"></a></h2>
<p>Generous use of whitespace, for example, a blank line before each block or task, makes a playbook easy to scan.</p>
</section>
<section id="always-name-plays-tasks-and-blocks">
<h2>Always name plays, tasks, and blocks<a class="headerlink" href="#always-name-plays-tasks-and-blocks" title="Link to this heading"></a></h2>
<p>Play, task, and block <code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">name:</span></code>’s are optional, but extremely useful. In its output, Ansible shows you the name of each named entity it runs.
Choose names that describe what each play, task, and block does and why.</p>
</section>
<section id="always-mention-the-state">
<h2>Always mention the state<a class="headerlink" href="#always-mention-the-state" title="Link to this heading"></a></h2>
<p>For many modules, the <code class="docutils literal notranslate"><span class="pre">state</span></code> parameter is optional.</p>
<p>Different modules have different default settings for <code class="docutils literal notranslate"><span class="pre">state</span></code>, and some modules support several <code class="docutils literal notranslate"><span class="pre">state</span></code> settings.
Explicitly setting <code class="docutils literal notranslate"><span class="pre">state:</span> <span class="pre">present</span></code> or <code class="docutils literal notranslate"><span class="pre">state:</span> <span class="pre">absent</span></code> makes playbooks and roles clearer.</p>
</section>
<section id="use-comments">
<h2>Use comments<a class="headerlink" href="#use-comments" title="Link to this heading"></a></h2>
<p>Even with task names and explicit states, sometimes a part of a playbook or role (or inventory/variable file) needs more explanation.
Adding a comment (any line starting with <code class="docutils literal notranslate"><span class="pre">#</span></code>) helps others (and possibly yourself in the future) understand what a play or task (or variable setting) does, how it does it, and why.</p>
</section>
<section id="use-fully-qualified-collection-names">
<h2>Use fully qualified collection names<a class="headerlink" href="#use-fully-qualified-collection-names" title="Link to this heading"></a></h2>
<p>Use <a class="reference external" href="https://docs.ansible.com/ansible/latest/reference_appendices/glossary.html#term-Fully-Qualified-Collection-Name-FQCN">fully qualified collection names (FQCN)</a> to avoid ambiguity in which collection to search for the correct module or plugin for each task.</p>
<p>For <a class="reference external" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/index.html#plugin-index">builtin modules and plugins</a>, use the <code class="docutils literal notranslate"><span class="pre">ansible.builtin</span></code> collection name as a prefix, for example, <code class="docutils literal notranslate"><span class="pre">ansible.builtin.copy</span></code>.</p>
</section>
</section>
<section id="inventory-tips">
<span id="id2"></span><h1>Inventory tips<a class="headerlink" href="#inventory-tips" title="Link to this heading"></a></h1>
<p>These tips help keep your inventory well organized.</p>
<section id="use-dynamic-inventory-with-clouds">
<h2>Use dynamic inventory with clouds<a class="headerlink" href="#use-dynamic-inventory-with-clouds" title="Link to this heading"></a></h2>
<p>With cloud providers and other systems that maintain canonical lists of your infrastructure, use <a class="reference internal" href="../inventory_guide/intro_dynamic_inventory.html#intro-dynamic-inventory"><span class="std std-ref">dynamic inventory</span></a> to retrieve those lists instead of manually updating static inventory files.
With cloud resources, you can use tags to differentiate production and staging environments.</p>
</section>
<section id="group-inventory-by-function">
<h2>Group inventory by function<a class="headerlink" href="#group-inventory-by-function" title="Link to this heading"></a></h2>
<p>A system can be in multiple groups.  See <a class="reference internal" href="../inventory_guide/intro_inventory.html#intro-inventory"><span class="std std-ref">How to build your inventory</span></a> and <a class="reference internal" href="../inventory_guide/intro_patterns.html#intro-patterns"><span class="std std-ref">Patterns: targeting hosts and groups</span></a>.
If you create groups named for the function of the nodes in the group, for example, <code class="docutils literal notranslate"><span class="pre">webservers</span></code> or <code class="docutils literal notranslate"><span class="pre">dbservers</span></code>, your playbooks can target machines based on function.
You can assign function-specific variables using the group variable system, and design Ansible roles to handle function-specific use cases.
See <a class="reference internal" href="../playbook_guide/playbooks_reuse_roles.html#playbooks-reuse-roles"><span class="std std-ref">Roles</span></a>.</p>
</section>
<section id="separate-production-and-staging-inventory">
<h2>Separate production and staging inventory<a class="headerlink" href="#separate-production-and-staging-inventory" title="Link to this heading"></a></h2>
<p>You can keep your production environment separate from development, test, and staging environments by using separate inventory files or directories for each environment.
This way you pick with -i what you are targeting.
Keeping all your environments in one file can lead to surprises!
For example, all vault passwords used in an inventory need to be available when using that inventory.
If an inventory contains both production and development environments, developers using that inventory would be able to access production secrets.</p>
</section>
<section id="keep-vaulted-variables-safely-visible">
<span id="tip-for-variables-and-vaults"></span><h2>Keep vaulted variables safely visible<a class="headerlink" href="#keep-vaulted-variables-safely-visible" title="Link to this heading"></a></h2>
<p>You should encrypt sensitive or secret variables with Ansible Vault.
However, encrypting the variable names as well as the variable values makes it hard to find the source of the values.
To circumvent this, you can encrypt the variables individually using <code class="docutils literal notranslate"><span class="pre">ansible-vault</span> <span class="pre">encrypt_string</span></code>, or add the following layer of indirection to keep the names of your variables accessible (by <code class="docutils literal notranslate"><span class="pre">grep</span></code>, for example) without exposing any secrets:</p>
<ol class="arabic simple">
<li><p>Create a <code class="docutils literal notranslate"><span class="pre">group_vars/</span></code> subdirectory named after the group.</p></li>
<li><p>Inside this subdirectory, create two files named <code class="docutils literal notranslate"><span class="pre">vars</span></code> and <code class="docutils literal notranslate"><span class="pre">vault</span></code>.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">vars</span></code> file, define all of the variables needed, including any sensitive ones.</p></li>
<li><p>Copy all of the sensitive variables over to the <code class="docutils literal notranslate"><span class="pre">vault</span></code> file and prefix these variables with <code class="docutils literal notranslate"><span class="pre">vault_</span></code>.</p></li>
<li><p>Adjust the variables in the <code class="docutils literal notranslate"><span class="pre">vars</span></code> file to point to the matching <code class="docutils literal notranslate"><span class="pre">vault_</span></code> variables using jinja2 syntax: <code class="docutils literal notranslate"><span class="pre">db_password:</span> <span class="pre">&quot;{{</span> <span class="pre">vault_db_password</span> <span class="pre">}}&quot;</span></code>.</p></li>
<li><p>Encrypt the <code class="docutils literal notranslate"><span class="pre">vault</span></code> file to protect its contents.</p></li>
<li><p>Use the variable name from the <code class="docutils literal notranslate"><span class="pre">vars</span></code> file in your playbooks.</p></li>
</ol>
<p>When running a playbook, Ansible finds the variables in the unencrypted file, which pulls the sensitive variable values from the encrypted file.
There is no limit to the number of variable and vault files or their names.</p>
<p>Note that using this strategy in your inventory still requires <em>all vault passwords to be available</em> (for example for <code class="docutils literal notranslate"><span class="pre">ansible-playbook</span></code> or <a class="reference external" href="https://github.com/ansible/awx/issues/223#issuecomment-768386089">AWX/Ansible Tower</a>) when run with that inventory.</p>
</section>
</section>
<section id="execution-tricks">
<span id="execution-tips"></span><h1>Execution tricks<a class="headerlink" href="#execution-tricks" title="Link to this heading"></a></h1>
<p>These tips apply to using Ansible, rather than to Ansible artifacts.</p>
<section id="use-execution-environments">
<h2>Use Execution Environments<a class="headerlink" href="#use-execution-environments" title="Link to this heading"></a></h2>
<p>Reduce complexity with portable container images known as <a class="reference external" href="https://ansible.readthedocs.io/en/latest/getting_started_ee/index.html">Execution Environments</a>.</p>
</section>
<section id="try-it-in-staging-first">
<h2>Try it in staging first<a class="headerlink" href="#try-it-in-staging-first" title="Link to this heading"></a></h2>
<p>Testing changes in a staging environment before rolling them out in production is always a great idea.
Your environments need not be the same size, and you can use group variables to control the differences between environments. You can also check for any syntax errors in the staging environment using the flag <code class="docutils literal notranslate"><span class="pre">--syntax-check</span></code> such as in the following example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">ansible-playbook --syntax-check</span>
</pre></div>
</div>
</section>
<section id="update-in-batches">
<h2>Update in batches<a class="headerlink" href="#update-in-batches" title="Link to this heading"></a></h2>
<p>Use the <code class="docutils literal notranslate"><span class="pre">serial</span></code> keyword to control how many machines you update at once in the batch.
See <a class="reference internal" href="../playbook_guide/playbooks_delegation.html#playbooks-delegation"><span class="std std-ref">Controlling where tasks run: delegation and local actions</span></a>.</p>
</section>
<section id="handling-os-and-distro-differences">
<span id="os-variance"></span><h2>Handling OS and distro differences<a class="headerlink" href="#handling-os-and-distro-differences" title="Link to this heading"></a></h2>
<p>Group variables files and the <code class="docutils literal notranslate"><span class="pre">group_by</span></code> module work together to help Ansible execute across a range of operating systems and distributions that require different settings, packages, and tools.
The <code class="docutils literal notranslate"><span class="pre">group_by</span></code> module creates a dynamic group of hosts that match certain criteria.
This group does not need to be defined in the inventory file.
This approach lets you execute different tasks on different operating systems or distributions.</p>
<p>For example, the following play categorizes all systems into dynamic groups based on the operating system name:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Talk to all hosts just so we can learn about them</span>
<span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Classify hosts depending on their OS distribution</span>
<span class="w">      </span><span class="nt">ansible.builtin.group_by</span><span class="p">:</span>
<span class="w">        </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">os_{{ ansible_facts[&#39;distribution&#39;] }}</span>
</pre></div>
</div>
<p>Subsequent plays can use these groups as patterns on the <code class="docutils literal notranslate"><span class="pre">hosts</span></code> line as follows:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">os_CentOS</span>
<span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>

<span class="w">    </span><span class="c1"># Tasks for CentOS hosts only go in this play.</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ping my CentOS hosts</span>
<span class="w">      </span><span class="nt">ansible.builtin.ping</span><span class="p">:</span>
</pre></div>
</div>
<p>You can also add group-specific settings in group vars files.
In the following example, CentOS machines get the value of ‘42’ for <cite>asdf</cite> but other machines get ‘10’.
You can also use group vars files to apply roles to systems as well as set variables.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="c1"># file: group_vars/all</span>
<span class="nt">asdf</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>

<span class="nn">---</span>
<span class="c1"># file: group_vars/os_CentOS.yml</span>
<span class="nt">asdf</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">42</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All three names must match: the name created by the <code class="docutils literal notranslate"><span class="pre">group_by</span></code> task, the name of the pattern in subsequent plays, and the name of the group vars file.</p>
</div>
<p>You can use the same setup with <code class="docutils literal notranslate"><span class="pre">include_vars</span></code> when you only need OS-specific variables, not tasks:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Use include_vars to include OS-specific variables and print them</span>
<span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set OS distribution dependent variables</span>
<span class="w">      </span><span class="nt">ansible.builtin.include_vars</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;os_{{</span><span class="nv"> </span><span class="s">ansible_facts[&#39;distribution&#39;]</span><span class="nv"> </span><span class="s">}}.yml&quot;</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Print the variable</span>
<span class="w">      </span><span class="nt">ansible.builtin.debug</span><span class="p">:</span>
<span class="w">        </span><span class="nt">var</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asdf</span>
</pre></div>
</div>
<p>This pulls in variables from the <cite>group_vars/os_CentOS.yml</cite> file.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../reference_appendices/YAMLSyntax.html#yaml-syntax"><span class="std std-ref">YAML Syntax</span></a></dt><dd><p>Learn about YAML syntax</p>
</dd>
<dt><a class="reference internal" href="../playbook_guide/playbooks.html#working-with-playbooks"><span class="std std-ref">Working with playbooks</span></a></dt><dd><p>Review the basic playbook features</p>
</dd>
<dt><a class="reference internal" href="../collections/index.html#list-of-collections"><span class="std std-ref">Collection Index</span></a></dt><dd><p>Browse existing collections, modules, and plugins</p>
</dd>
<dt><a class="reference internal" href="../dev_guide/developing_modules.html#developing-modules"><span class="std std-ref">Should you develop a module?</span></a></dt><dd><p>Learn how to extend Ansible by writing your own modules</p>
</dd>
<dt><a class="reference internal" href="../inventory_guide/intro_patterns.html#intro-patterns"><span class="std std-ref">Patterns: targeting hosts and groups</span></a></dt><dd><p>Learn about how to select hosts</p>
</dd>
<dt><a class="reference external" href="https://github.com/ansible/ansible-examples">GitHub examples directory</a></dt><dd><p>Complete playbook files from the GitHub project source</p>
</dd>
<dt><a class="reference external" href="https://groups.google.com/group/ansible-project">Mailing List</a></dt><dd><p>Questions? Help? Ideas?  Stop by the list on Google Groups</p>
</dd>
</dl>
</div>
</section>
</section>


           </div>
          </div>
          

<footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Ansible tips and tricks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="sample_setup.html" class="btn btn-neutral float-right" title="Sample Ansible setup" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Ansible project contributors.
      <span class="lastupdated">Last updated on Jun 13, 2024.
      </span></p>
  </div>

  
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script><!-- extra footer elements for Ansible beyond RTD Sphinx Theme -->
<!-- begin analytics -->
<script>
var _hsq = _hsq || [];
_hsq.push(["setContentType", "standard-page"]);
      (function(d,s,i,r) {
      if (d.getElementById(i)){return;}
      var n = d.createElement(s),e = document.getElementsByTagName(s)[0];
      n.id=i;n.src = 'https://js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/330046.js';
      e.parentNode.insertBefore(n, e);
      })(document, "script", "hs-analytics",300000);
</script>
<!-- end analytics -->
<script>
if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
  _satellite.pageBottom();
}
</script>

</body>
</html>